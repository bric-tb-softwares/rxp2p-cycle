----------------- Options ---------------
               batch_size: 1                             
                    beta1: 0.5                           
          checkpoints_dir: /home/otto.tavares/public/iltbi/rxpixp2pixcycle/checkpoints
           continue_train: False                         
                crop_size: 256                           
       custom_images_path: /home/otto.tavares/public/iltbi/train/images/santa_casa_pares/	[default: None]
        custom_masks_path: None                          
       custom_paired_path: None                          
                 dataroot: /home/otto.tavares/public/iltbi/train/images/santa_casa_pares/	[default: None]
           dataset_action: False                         
     dataset_download_dir: /home/otto.tavares/public/iltbi/rxpixp2pixcycle
             dataset_mode: santacasaskfold               	[default: aligned]
             dataset_name: Shenzhen                      
                direction: AtoB                          
              display_env: main                          
             display_freq: 400                           
               display_id: 1                             
            display_ncols: 4                             
             display_port: 8097                          
           display_server: http://localhost              
          display_winsize: 256                           
            download_imgs: False                         
                    epoch: latest                        
              epoch_count: 1                             
                 gan_mode: lsgan                         	[default: vanilla]
  generate_paths_data_csv: False                         
                  gpu_ids: 0                             
                init_gain: 0.02                          
                init_type: normal                        
                 input_nc: 3                             
                     isTB: False                         
                  isTrain: True                          	[default: None]
          is_resume_wandb: False                         
                      job: None                          
                lambda_L1: 50.0                          	[default: 100.0]
                load_iter: 0                             	[default: 0]
                load_size: 256                           	[default: 286]
                       lr: 0.0002                        
           lr_decay_iters: 50                            
                lr_policy: linear                        
         max_dataset_size: inf                           
                    model: pix2pix                       	[default: cycle_gan]
                 n_epochs: 100                           
           n_epochs_decay: 100                           
                  n_folds: 10                            
               n_layers_D: 3                             
                     name: santacasa_test_0_sort_4       	[default: experiment_name]
                      ndf: 64                            
                     netD: basic                         
                     netG: unet_256                      
                      ngf: 64                            
               no_dropout: False                         
                  no_flip: False                         
                  no_html: False                         
                     norm: batch                         
              num_threads: 4                             
                  num_val: 400                           
                output_nc: 3                             
                    phase: train                         
                pool_size: 0                             
               preprocess: resize_and_scale_width        	[default: resize_and_crop]
               print_freq: 100                           
                  project: p2p_santacasa                 	[default: None]
             save_by_iter: False                         
          save_epoch_freq: 5                             
         save_latest_freq: 5000                          
                     seed: 512                           	[default: 512]
           serial_batches: False                         
                     sort: 4                             	[default: 0]
                   suffix:                               
                     test: 0                             
                    token:                               
            train_dataset: True                          
         update_html_freq: 1000                          
                use_wandb: True                          	[default: False]
                 val_freq: 10                            	[default: 400]
                  verbose: False                         
             wandb_entity: otavares                      	[default: brics-tb]
            wandb_fold_id: wandb__id_test_0_sort_4       	[default: None]
----------------- End -------------------
GPU with device 0
                 images    gauss  ... all_together target
0   20220315_184023.jpg      seg  ...          seg      0
1   20220315_184432.jpg      seg  ...          seg      0
2   20220315_184701.jpg  not seg  ...          seg      0
3   20220315_184740.jpg      seg  ...          seg      0
4   20220315_185230.jpg      seg  ...          seg      0
..                  ...      ...  ...          ...    ...
83         IMG_5503.JPG  not seg  ...      not seg      0
84         IMG_5505.JPG      seg  ...          seg      0
85         IMG_5507.JPG      seg  ...          seg      0
86         IMG_5509.JPG      seg  ...          seg      0
87         IMG_5604.JPG      seg  ...          seg      0

[88 rows x 5 columns]
bins selected for val: [1, 2, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 2, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 7, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 7, 8]
dataset [SantaCasaSkfoldDataset] was created
                 images    gauss  ... all_together target
0   20220315_184023.jpg      seg  ...          seg      0
1   20220315_184432.jpg      seg  ...          seg      0
2   20220315_184701.jpg  not seg  ...          seg      0
3   20220315_184740.jpg      seg  ...          seg      0
4   20220315_185230.jpg      seg  ...          seg      0
..                  ...      ...  ...          ...    ...
83         IMG_5503.JPG  not seg  ...      not seg      0
84         IMG_5505.JPG      seg  ...          seg      0
85         IMG_5507.JPG      seg  ...          seg      0
86         IMG_5509.JPG      seg  ...          seg      0
87         IMG_5604.JPG      seg  ...          seg      0

[88 rows x 5 columns]
bins selected for val: [1, 2, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 2, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 7, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 7, 8]
dataset [SantaCasaSkfoldDataset] was created
The number of training images = 41
The number of val images = 5
initialize network with normal
initialize network with normal
model [Pix2PixModel] was created
---------- Networks initialized -------------
[Network G] Total number of parameters : 54.414 M
[Network D] Total number of parameters : 2.769 M
-----------------------------------------------
Exception in user code:
------------------------------------------------------------


Could not connect to Visdom server. 
 Trying to start a server....
Command: /usr/bin/python3 -m visdom.server -p 8097 &>/dev/null &
create web directory /home/otto.tavares/public/iltbi/rxpixp2pixcycle/checkpoints/santacasa_test_0_sort_4/web...
learning rate 0.0002000 -> 0.0002000
End of epoch 1 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 2 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.2914153039455414), ('G_L1', 4.824916839599609), ('D_real', 0.244493305683136), ('D_fake', 0.3011220395565033), ('KL_realB_fakeB', 0.5770833936176023)])
(epoch: 3, iters: 18, time: 0.057, data: 0.310) G_GAN: 0.291 G_L1: 4.825 D_real: 0.244 D_fake: 0.301 KL_realB_fakeB: 0.577 
End of epoch 3 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 4 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.27955877780914307), ('G_L1', 5.0985870361328125), ('D_real', 0.2538275122642517), ('D_fake', 0.26103878021240234), ('KL_realB_fakeB', 0.2745816103535499)])
(epoch: 5, iters: 36, time: 0.056, data: 1.378) G_GAN: 0.280 G_L1: 5.099 D_real: 0.254 D_fake: 0.261 KL_realB_fakeB: 0.275 
saving the model at the end of epoch 5, iters 205
End of epoch 5 / 200 	 Time Taken: 8 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 6 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 7 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.32125863432884216), ('G_L1', 7.78731107711792), ('D_real', 0.21844014525413513), ('D_fake', 0.27756279706954956), ('KL_realB_fakeB', 0.14751905786212444)])
(epoch: 8, iters: 13, time: 0.055, data: 2.352) G_GAN: 0.321 G_L1: 7.787 D_real: 0.218 D_fake: 0.278 KL_realB_fakeB: 0.148 
End of epoch 8 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 9 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.2587594985961914), ('G_L1', 3.610388994216919), ('D_real', 0.2603122889995575), ('D_fake', 0.27752283215522766), ('KL_realB_fakeB', 0.094047500529224)])
(epoch: 10, iters: 31, time: 0.816, data: 1.044) G_GAN: 0.259 G_L1: 3.610 D_real: 0.260 D_fake: 0.278 KL_realB_fakeB: 0.094 
OrderedDict([('G_GAN_val', 0.29874634742736816), ('G_L1_val', 3.557760000228882), ('D_real_val', 0.27303972840309143), ('D_fake_val', 0.31253960728645325), ('KL_realB_fakeB_val', 0.13612589613514972)])
end of validation step
OrderedDict([('G_GAN_val', 0.30379700660705566), ('G_L1_val', 4.190696716308594), ('D_real_val', 0.2843647301197052), ('D_fake_val', 0.3816065788269043), ('KL_realB_fakeB_val', 0.19054705765107044)])
end of validation step
OrderedDict([('G_GAN_val', 0.30121251940727234), ('G_L1_val', 4.570728302001953), ('D_real_val', 0.2807462513446808), ('D_fake_val', 0.3871731758117676), ('KL_realB_fakeB_val', 0.22909643403841176)])
end of validation step
OrderedDict([('G_GAN_val', 0.314165860414505), ('G_L1_val', 4.500722885131836), ('D_real_val', 0.2829514443874359), ('D_fake_val', 0.3522109091281891), ('KL_realB_fakeB_val', 0.16751682751244523)])
end of validation step
OrderedDict([('G_GAN_val', 0.35045504570007324), ('G_L1_val', 3.465956926345825), ('D_real_val', 0.33983945846557617), ('D_fake_val', 0.36386096477508545), ('KL_realB_fakeB_val', 0.08162346931918915)])
end of validation step
saving the model at the end of epoch 10, iters 410
End of epoch 10 / 200 	 Time Taken: 8 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 11 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 12 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.31223931908607483), ('G_L1', 4.230368137359619), ('D_real', 0.17967255413532257), ('D_fake', 0.3060053586959839), ('KL_realB_fakeB', 1.081682901815052)])
(epoch: 13, iters: 8, time: 0.059, data: 2.871) G_GAN: 0.312 G_L1: 4.230 D_real: 0.180 D_fake: 0.306 KL_realB_fakeB: 1.082 
End of epoch 13 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 14 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.317175954580307), ('G_L1', 4.463615894317627), ('D_real', 0.24231889843940735), ('D_fake', 0.2590295374393463), ('KL_realB_fakeB', 0.2047995377727986)])
(epoch: 15, iters: 26, time: 0.057, data: 0.810) G_GAN: 0.317 G_L1: 4.464 D_real: 0.242 D_fake: 0.259 KL_realB_fakeB: 0.205 
saving the model at the end of epoch 15, iters 615
End of epoch 15 / 200 	 Time Taken: 8 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 16 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 17 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.3983535170555115), ('G_L1', 2.4240965843200684), ('D_real', 0.4345184862613678), ('D_fake', 0.303725928068161), ('KL_realB_fakeB', 0.11116232466778085)])
(epoch: 18, iters: 3, time: 0.040, data: 1.858) G_GAN: 0.398 G_L1: 2.424 D_real: 0.435 D_fake: 0.304 KL_realB_fakeB: 0.111 
End of epoch 18 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 19 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
