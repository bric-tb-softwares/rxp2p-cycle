----------------- Options ---------------
               batch_size: 1                             
                    beta1: 0.5                           
          checkpoints_dir: /home/otto.tavares/public/iltbi/rxpixp2pixcycle/checkpoints
           continue_train: False                         
                crop_size: 256                           
       custom_images_path: /home/otto.tavares/public/iltbi/train/images/santa_casa_pares/	[default: None]
        custom_masks_path: None                          
       custom_paired_path: None                          
                 dataroot: /home/otto.tavares/public/iltbi/train/images/santa_casa_pares/	[default: None]
           dataset_action: False                         
     dataset_download_dir: /home/otto.tavares/public/iltbi/rxpixp2pixcycle
             dataset_mode: santacasaskfold               	[default: aligned]
             dataset_name: Shenzhen                      
                direction: AtoB                          
              display_env: main                          
             display_freq: 400                           
               display_id: 1                             
            display_ncols: 4                             
             display_port: 8097                          
           display_server: http://localhost              
          display_winsize: 256                           
            download_imgs: False                         
                    epoch: latest                        
              epoch_count: 1                             
                 gan_mode: lsgan                         	[default: vanilla]
  generate_paths_data_csv: False                         
                  gpu_ids: 0                             
                init_gain: 0.02                          
                init_type: normal                        
                 input_nc: 3                             
                     isTB: False                         
                  isTrain: True                          	[default: None]
          is_resume_wandb: False                         
                      job: None                          
                lambda_L1: 50.0                          	[default: 100.0]
                load_iter: 0                             	[default: 0]
                load_size: 256                           	[default: 286]
                       lr: 0.0002                        
           lr_decay_iters: 50                            
                lr_policy: linear                        
         max_dataset_size: inf                           
                    model: pix2pix                       	[default: cycle_gan]
                 n_epochs: 100                           
           n_epochs_decay: 100                           
                  n_folds: 10                            
               n_layers_D: 3                             
                     name: rxcycle_shenzhen_iltbi_santacasa	[default: experiment_name]
                      ndf: 64                            
                     netD: basic                         
                     netG: unet_256                      
                      ngf: 64                            
               no_dropout: False                         
                  no_flip: False                         
                  no_html: False                         
                     norm: batch                         
              num_threads: 4                             
                  num_val: 400                           
                output_nc: 3                             
                    phase: train                         
                pool_size: 0                             
               preprocess: resize_and_scale_width        	[default: resize_and_crop]
               print_freq: 100                           
                  project: p2p_santacasa                 	[default: None]
             save_by_iter: False                         
          save_epoch_freq: 5                             
         save_latest_freq: 5000                          
                     seed: 512                           	[default: 512]
           serial_batches: False                         
                     sort: 1                             	[default: 0]
                   suffix:                               
                     test: 0                             
                    token:                               
            train_dataset: True                          
         update_html_freq: 1000                          
                use_wandb: True                          	[default: False]
                 val_freq: 10                            	[default: 400]
                  verbose: False                         
             wandb_entity: otavares                      	[default: brics-tb]
            wandb_fold_id: wandb_id-1                    	[default: None]
----------------- End -------------------
GPU with device 0
                 images    gauss  ... all_together target
0   20220315_184023.jpg      seg  ...          seg      0
1   20220315_184432.jpg      seg  ...          seg      0
2   20220315_184701.jpg  not seg  ...          seg      0
3   20220315_184740.jpg      seg  ...          seg      0
4   20220315_185230.jpg      seg  ...          seg      0
..                  ...      ...  ...          ...    ...
83         IMG_5503.JPG  not seg  ...      not seg      0
84         IMG_5505.JPG      seg  ...          seg      0
85         IMG_5507.JPG      seg  ...          seg      0
86         IMG_5509.JPG      seg  ...          seg      0
87         IMG_5604.JPG      seg  ...          seg      0

[88 rows x 5 columns]
bins selected for val: [1, 2, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 2, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 7, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 7, 8]
dataset [SantaCasaSkfoldDataset] was created
                 images    gauss  ... all_together target
0   20220315_184023.jpg      seg  ...          seg      0
1   20220315_184432.jpg      seg  ...          seg      0
2   20220315_184701.jpg  not seg  ...          seg      0
3   20220315_184740.jpg      seg  ...          seg      0
4   20220315_185230.jpg      seg  ...          seg      0
..                  ...      ...  ...          ...    ...
83         IMG_5503.JPG  not seg  ...      not seg      0
84         IMG_5505.JPG      seg  ...          seg      0
85         IMG_5507.JPG      seg  ...          seg      0
86         IMG_5509.JPG      seg  ...          seg      0
87         IMG_5604.JPG      seg  ...          seg      0

[88 rows x 5 columns]
bins selected for val: [1, 2, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 2, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 7, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 7, 8]
dataset [SantaCasaSkfoldDataset] was created
The number of training images = 40
The number of val images = 6
initialize network with normal
initialize network with normal
model [Pix2PixModel] was created
---------- Networks initialized -------------
[Network G] Total number of parameters : 54.414 M
[Network D] Total number of parameters : 2.769 M
-----------------------------------------------
Exception in user code:
------------------------------------------------------------


Could not connect to Visdom server. 
 Trying to start a server....
Command: /usr/bin/python3 -m visdom.server -p 8097 &>/dev/null &
create web directory /home/otto.tavares/public/iltbi/rxpixp2pixcycle/checkpoints/rxcycle_shenzhen_iltbi_santacasa/web...
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 1 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 2 / 200 	 Time Taken: 30 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.29948675632476807), ('G_L1', 6.942620754241943), ('D_real', 0.32354357838630676), ('D_fake', 0.30347633361816406), ('KL_realB_fakeB', 0.1518214142312425)])
(epoch: 3, iters: 20, time: 0.043, data: 0.127) G_GAN: 0.299 G_L1: 6.943 D_real: 0.324 D_fake: 0.303 KL_realB_fakeB: 0.152 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 3 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 4 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.28897491097450256), ('G_L1', 4.668747901916504), ('D_real', 0.28048068284988403), ('D_fake', 0.3042397201061249), ('KL_realB_fakeB', 0.13635385646431208)])
(epoch: 5, iters: 40, time: 0.044, data: 1.553) G_GAN: 0.289 G_L1: 4.669 D_real: 0.280 D_fake: 0.304 KL_realB_fakeB: 0.136 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 5, iters 200
End of epoch 5 / 200 	 Time Taken: 8 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 6 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 7 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.3129326403141022), ('G_L1', 5.109246253967285), ('D_real', 0.26485687494277954), ('D_fake', 0.23244671523571014), ('KL_realB_fakeB', 0.21252429386419608)])
(epoch: 8, iters: 20, time: 0.048, data: 0.512) G_GAN: 0.313 G_L1: 5.109 D_real: 0.265 D_fake: 0.232 KL_realB_fakeB: 0.213 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 8 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 9 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.30529162287712097), ('G_L1', 4.830505847930908), ('D_real', 0.2765703797340393), ('D_fake', 0.21712419390678406), ('KL_realB_fakeB', 0.21953888947200106)])
(epoch: 10, iters: 40, time: 0.819, data: 1.728) G_GAN: 0.305 G_L1: 4.831 D_real: 0.277 D_fake: 0.217 KL_realB_fakeB: 0.220 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 10, iters 400
End of epoch 10 / 200 	 Time Taken: 9 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 11 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 12 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.3399098813533783), ('G_L1', 4.000954627990723), ('D_real', 0.2547251284122467), ('D_fake', 0.29472559690475464), ('KL_realB_fakeB', 0.17911241801053182)])
(epoch: 13, iters: 20, time: 0.034, data: 0.452) G_GAN: 0.340 G_L1: 4.001 D_real: 0.255 D_fake: 0.295 KL_realB_fakeB: 0.179 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 13 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 14 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.244328111410141), ('G_L1', 5.554030418395996), ('D_real', 0.24515686929225922), ('D_fake', 0.23516087234020233), ('KL_realB_fakeB', 0.4633002659489661)])
(epoch: 15, iters: 40, time: 0.045, data: 1.268) G_GAN: 0.244 G_L1: 5.554 D_real: 0.245 D_fake: 0.235 KL_realB_fakeB: 0.463 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 15, iters 600
End of epoch 15 / 200 	 Time Taken: 9 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 16 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 17 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.4067269563674927), ('G_L1', 2.7407310009002686), ('D_real', 0.3705039620399475), ('D_fake', 0.3680502772331238), ('KL_realB_fakeB', 0.09821806658418133)])
(epoch: 18, iters: 20, time: 0.044, data: 0.141) G_GAN: 0.407 G_L1: 2.741 D_real: 0.371 D_fake: 0.368 KL_realB_fakeB: 0.098 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 18 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 19 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.3899502754211426), ('G_L1', 3.075810432434082), ('D_real', 0.18755412101745605), ('D_fake', 0.25771066546440125), ('KL_realB_fakeB', 0.13830884716237796)])
(epoch: 20, iters: 40, time: 0.624, data: 1.468) G_GAN: 0.390 G_L1: 3.076 D_real: 0.188 D_fake: 0.258 KL_realB_fakeB: 0.138 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 20, iters 800
End of epoch 20 / 200 	 Time Taken: 9 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 21 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 22 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.5392751097679138), ('G_L1', 3.2045490741729736), ('D_real', 0.4039418697357178), ('D_fake', 0.31747546792030334), ('KL_realB_fakeB', 0.11127697092014507)])
(epoch: 23, iters: 20, time: 0.034, data: 0.418) G_GAN: 0.539 G_L1: 3.205 D_real: 0.404 D_fake: 0.317 KL_realB_fakeB: 0.111 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 23 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 24 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.3587237000465393), ('G_L1', 2.6537320613861084), ('D_real', 0.3419479429721832), ('D_fake', 0.1252678781747818), ('KL_realB_fakeB', 0.20716053032456938)])
(epoch: 25, iters: 40, time: 0.034, data: 1.607) G_GAN: 0.359 G_L1: 2.654 D_real: 0.342 D_fake: 0.125 KL_realB_fakeB: 0.207 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 25, iters 1000
End of epoch 25 / 200 	 Time Taken: 10 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 26 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 27 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.2571161091327667), ('G_L1', 2.2975807189941406), ('D_real', 0.4920596778392792), ('D_fake', 0.1049327626824379), ('KL_realB_fakeB', 0.13211957856670825)])
(epoch: 28, iters: 20, time: 0.046, data: 0.085) G_GAN: 0.257 G_L1: 2.298 D_real: 0.492 D_fake: 0.105 KL_realB_fakeB: 0.132 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 28 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 29 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.34830859303474426), ('G_L1', 3.363297462463379), ('D_real', 0.18081292510032654), ('D_fake', 0.21308891475200653), ('KL_realB_fakeB', 0.33719473110116444)])
(epoch: 30, iters: 40, time: 0.685, data: 1.517) G_GAN: 0.348 G_L1: 3.363 D_real: 0.181 D_fake: 0.213 KL_realB_fakeB: 0.337 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 30, iters 1200
End of epoch 30 / 200 	 Time Taken: 11 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 31 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 32 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.5753973722457886), ('G_L1', 2.202831745147705), ('D_real', 0.18105784058570862), ('D_fake', 0.2170688956975937), ('KL_realB_fakeB', 0.10281215134939656)])
(epoch: 33, iters: 20, time: 0.053, data: 0.100) G_GAN: 0.575 G_L1: 2.203 D_real: 0.181 D_fake: 0.217 KL_realB_fakeB: 0.103 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 33 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 34 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.8032506108283997), ('G_L1', 2.2063238620758057), ('D_real', 0.05526862293481827), ('D_fake', 0.7923661470413208), ('KL_realB_fakeB', 0.127121313964782)])
(epoch: 35, iters: 40, time: 0.032, data: 1.662) G_GAN: 0.803 G_L1: 2.206 D_real: 0.055 D_fake: 0.792 KL_realB_fakeB: 0.127 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 35, iters 1400
End of epoch 35 / 200 	 Time Taken: 9 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 36 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 37 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.3268027603626251), ('G_L1', 2.499464511871338), ('D_real', 0.3394331932067871), ('D_fake', 0.11755646765232086), ('KL_realB_fakeB', 0.2696908064393608)])
(epoch: 38, iters: 20, time: 0.044, data: 0.107) G_GAN: 0.327 G_L1: 2.499 D_real: 0.339 D_fake: 0.118 KL_realB_fakeB: 0.270 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 38 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 39 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.23347388207912445), ('G_L1', 2.0400729179382324), ('D_real', 0.23944371938705444), ('D_fake', 0.09766064584255219), ('KL_realB_fakeB', 0.3448328375266418)])
(epoch: 40, iters: 40, time: 0.590, data: 1.737) G_GAN: 0.233 G_L1: 2.040 D_real: 0.239 D_fake: 0.098 KL_realB_fakeB: 0.345 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 40, iters 1600
End of epoch 40 / 200 	 Time Taken: 9 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 41 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 42 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.23427405953407288), ('G_L1', 2.0550355911254883), ('D_real', 0.19530043005943298), ('D_fake', 0.2762121856212616), ('KL_realB_fakeB', 0.09622086250183988)])
(epoch: 43, iters: 20, time: 0.045, data: 0.106) G_GAN: 0.234 G_L1: 2.055 D_real: 0.195 D_fake: 0.276 KL_realB_fakeB: 0.096 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 43 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 44 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.5442990064620972), ('G_L1', 2.6835992336273193), ('D_real', 0.19736576080322266), ('D_fake', 0.016954220831394196), ('KL_realB_fakeB', 0.2523155072269538)])
(epoch: 45, iters: 40, time: 0.054, data: 1.494) G_GAN: 0.544 G_L1: 2.684 D_real: 0.197 D_fake: 0.017 KL_realB_fakeB: 0.252 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 45, iters 1800
End of epoch 45 / 200 	 Time Taken: 8 sec
learning rate 0.0002000 -> 0.0002000
