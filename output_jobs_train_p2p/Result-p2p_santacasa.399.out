----------------- Options ---------------
               batch_size: 1                             
                    beta1: 0.5                           
          checkpoints_dir: /home/otto.tavares/public/iltbi/rxpixp2pixcycle/checkpoints
           continue_train: False                         
                crop_size: 256                           
       custom_images_path: /home/otto.tavares/public/iltbi/train/images/santa_casa_pares/	[default: None]
        custom_masks_path: None                          
       custom_paired_path: None                          
                 dataroot: /home/otto.tavares/public/iltbi/train/images/santa_casa_pares/	[default: None]
           dataset_action: False                         
     dataset_download_dir: /home/otto.tavares/public/iltbi/rxpixp2pixcycle
             dataset_mode: santacasaskfold               	[default: aligned]
             dataset_name: Shenzhen                      
                direction: AtoB                          
              display_env: main                          
             display_freq: 400                           
               display_id: 1                             
            display_ncols: 4                             
             display_port: 8097                          
           display_server: http://localhost              
          display_winsize: 256                           
            download_imgs: False                         
                    epoch: latest                        
              epoch_count: 1                             
                 gan_mode: lsgan                         	[default: vanilla]
  generate_paths_data_csv: False                         
                  gpu_ids: 0                             
                init_gain: 0.02                          
                init_type: normal                        
                 input_nc: 3                             
                     isTB: False                         
                  isTrain: True                          	[default: None]
          is_resume_wandb: False                         
                      job: None                          
                lambda_L1: 50.0                          	[default: 100.0]
                load_iter: 0                             	[default: 0]
                load_size: 256                           	[default: 286]
                       lr: 0.0002                        
           lr_decay_iters: 50                            
                lr_policy: linear                        
         max_dataset_size: inf                           
                    model: pix2pix                       	[default: cycle_gan]
                 n_epochs: 100                           
           n_epochs_decay: 100                           
                  n_folds: 10                            
               n_layers_D: 3                             
                     name: santacasa_test_0_sort_2       	[default: experiment_name]
                      ndf: 64                            
                     netD: basic                         
                     netG: unet_256                      
                      ngf: 64                            
               no_dropout: False                         
                  no_flip: False                         
                  no_html: False                         
                     norm: batch                         
              num_threads: 4                             
                  num_val: 400                           
                output_nc: 3                             
                    phase: train                         
                pool_size: 0                             
               preprocess: resize_and_scale_width        	[default: resize_and_crop]
               print_freq: 100                           
                  project: p2p_santacasa                 	[default: None]
             save_by_iter: False                         
          save_epoch_freq: 5                             
         save_latest_freq: 5000                          
                     seed: 512                           	[default: 512]
           serial_batches: False                         
                     sort: 2                             	[default: 0]
                   suffix:                               
                     test: 0                             
                    token:                               
            train_dataset: True                          
         update_html_freq: 1000                          
                use_wandb: True                          	[default: False]
                 val_freq: 10                            	[default: 400]
                  verbose: False                         
             wandb_entity: otavares                      	[default: brics-tb]
            wandb_fold_id: wandb_id_test_0_sort_2        	[default: None]
----------------- End -------------------
GPU with device 0
                 images    gauss  ... all_together target
0   20220315_184023.jpg      seg  ...          seg      0
1   20220315_184432.jpg      seg  ...          seg      0
2   20220315_184701.jpg  not seg  ...          seg      0
3   20220315_184740.jpg      seg  ...          seg      0
4   20220315_185230.jpg      seg  ...          seg      0
..                  ...      ...  ...          ...    ...
83         IMG_5503.JPG  not seg  ...      not seg      0
84         IMG_5505.JPG      seg  ...          seg      0
85         IMG_5507.JPG      seg  ...          seg      0
86         IMG_5509.JPG      seg  ...          seg      0
87         IMG_5604.JPG      seg  ...          seg      0

[88 rows x 5 columns]
bins selected for val: [1, 2, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 2, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 7, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 7, 8]
dataset [SantaCasaSkfoldDataset] was created
                 images    gauss  ... all_together target
0   20220315_184023.jpg      seg  ...          seg      0
1   20220315_184432.jpg      seg  ...          seg      0
2   20220315_184701.jpg  not seg  ...          seg      0
3   20220315_184740.jpg      seg  ...          seg      0
4   20220315_185230.jpg      seg  ...          seg      0
..                  ...      ...  ...          ...    ...
83         IMG_5503.JPG  not seg  ...      not seg      0
84         IMG_5505.JPG      seg  ...          seg      0
85         IMG_5507.JPG      seg  ...          seg      0
86         IMG_5509.JPG      seg  ...          seg      0
87         IMG_5604.JPG      seg  ...          seg      0

[88 rows x 5 columns]
bins selected for val: [1, 2, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 2, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 7, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 7, 8]
dataset [SantaCasaSkfoldDataset] was created
The number of training images = 38
The number of val images = 8
initialize network with normal
initialize network with normal
model [Pix2PixModel] was created
---------- Networks initialized -------------
[Network G] Total number of parameters : 54.414 M
[Network D] Total number of parameters : 2.769 M
-----------------------------------------------
Exception in user code:
------------------------------------------------------------


Could not connect to Visdom server. 
 Trying to start a server....
Command: /usr/bin/python3 -m visdom.server -p 8097 &>/dev/null &
create web directory /home/otto.tavares/public/iltbi/rxpixp2pixcycle/checkpoints/santacasa_test_0_sort_2/web...
learning rate 0.0002000 -> 0.0002000
End of epoch 1 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 2 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.3231656551361084), ('G_L1', 4.779633045196533), ('D_real', 0.28728726506233215), ('D_fake', 0.2577795684337616), ('KL_realB_fakeB', 1.0183211669145171)])
(epoch: 3, iters: 24, time: 0.046, data: 0.107) G_GAN: 0.323 G_L1: 4.780 D_real: 0.287 D_fake: 0.258 KL_realB_fakeB: 1.018 
End of epoch 3 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 4 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 5, iters 190
End of epoch 5 / 200 	 Time Taken: 7 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.3984629511833191), ('G_L1', 3.9803006649017334), ('D_real', 0.45028361678123474), ('D_fake', 0.46702462434768677), ('KL_realB_fakeB', 0.7559721188928663)])
(epoch: 6, iters: 10, time: 0.048, data: 1.774) G_GAN: 0.398 G_L1: 3.980 D_real: 0.450 D_fake: 0.467 KL_realB_fakeB: 0.756 
End of epoch 6 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 7 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.2821101248264313), ('G_L1', 5.093378067016602), ('D_real', 0.2665169835090637), ('D_fake', 0.2656160295009613), ('KL_realB_fakeB', 0.24356056456476505)])
(epoch: 8, iters: 34, time: 0.049, data: 0.951) G_GAN: 0.282 G_L1: 5.093 D_real: 0.267 D_fake: 0.266 KL_realB_fakeB: 0.244 
End of epoch 8 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 9 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 10, iters 380
End of epoch 10 / 200 	 Time Taken: 8 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.3080620765686035), ('G_L1', 2.8534741401672363), ('D_real', 0.3386280834674835), ('D_fake', 0.25684434175491333), ('KL_realB_fakeB', 0.1069662504495002)])
(epoch: 11, iters: 20, time: 0.731, data: 2.479) G_GAN: 0.308 G_L1: 2.853 D_real: 0.339 D_fake: 0.257 KL_realB_fakeB: 0.107 
End of epoch 11 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 12 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 13 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.333003431558609), ('G_L1', 5.542837142944336), ('D_real', 0.20047655701637268), ('D_fake', 0.3057013750076294), ('KL_realB_fakeB', 0.1704966899741698)])
(epoch: 14, iters: 6, time: 0.045, data: 2.399) G_GAN: 0.333 G_L1: 5.543 D_real: 0.200 D_fake: 0.306 KL_realB_fakeB: 0.170 
End of epoch 14 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 15, iters 570
End of epoch 15 / 200 	 Time Taken: 8 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.27681854367256165), ('G_L1', 2.806896448135376), ('D_real', 0.21565033495426178), ('D_fake', 0.2797422409057617), ('KL_realB_fakeB', 0.5470577324590867)])
(epoch: 16, iters: 30, time: 0.046, data: 0.608) G_GAN: 0.277 G_L1: 2.807 D_real: 0.216 D_fake: 0.280 KL_realB_fakeB: 0.547 
End of epoch 16 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 17 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 18 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.3802543878555298), ('G_L1', 2.692811965942383), ('D_real', 0.2588880658149719), ('D_fake', 0.354641854763031), ('KL_realB_fakeB', 0.20371392617353296)])
(epoch: 19, iters: 16, time: 0.049, data: 1.925) G_GAN: 0.380 G_L1: 2.693 D_real: 0.259 D_fake: 0.355 KL_realB_fakeB: 0.204 
End of epoch 19 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 20, iters 760
End of epoch 20 / 200 	 Time Taken: 7 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 21 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.5533740520477295), ('G_L1', 3.662733316421509), ('D_real', 0.4237827956676483), ('D_fake', 0.3030901551246643), ('KL_realB_fakeB', 0.22011711151958047)])
(epoch: 22, iters: 2, time: 0.504, data: 1.427) G_GAN: 0.553 G_L1: 3.663 D_real: 0.424 D_fake: 0.303 KL_realB_fakeB: 0.220 
End of epoch 22 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 23 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.24708381295204163), ('G_L1', 2.8792836666107178), ('D_real', 0.22463864088058472), ('D_fake', 0.2803531885147095), ('KL_realB_fakeB', 0.20629330985780697)])
(epoch: 24, iters: 26, time: 0.048, data: 1.024) G_GAN: 0.247 G_L1: 2.879 D_real: 0.225 D_fake: 0.280 KL_realB_fakeB: 0.206 
End of epoch 24 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 25, iters 950
End of epoch 25 / 200 	 Time Taken: 8 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 26 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.26105669140815735), ('G_L1', 2.555504322052002), ('D_real', 0.21500560641288757), ('D_fake', 0.22523000836372375), ('KL_realB_fakeB', 0.0797644814696119)])
(epoch: 27, iters: 12, time: 0.048, data: 1.858) G_GAN: 0.261 G_L1: 2.556 D_real: 0.215 D_fake: 0.225 KL_realB_fakeB: 0.080 
End of epoch 27 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 28 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.2768034338951111), ('G_L1', 2.400860548019409), ('D_real', 0.23344089090824127), ('D_fake', 0.27028194069862366), ('KL_realB_fakeB', 0.15646286223925776)])
(epoch: 29, iters: 36, time: 0.049, data: 0.967) G_GAN: 0.277 G_L1: 2.401 D_real: 0.233 D_fake: 0.270 KL_realB_fakeB: 0.156 
End of epoch 29 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 30, iters 1140
End of epoch 30 / 200 	 Time Taken: 7 sec
learning rate 0.0002000 -> 0.0002000
End of epoch 31 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.3644871711730957), ('G_L1', 1.907862663269043), ('D_real', 0.2672669589519501), ('D_fake', 0.31487399339675903), ('KL_realB_fakeB', 0.10511349478131732)])
(epoch: 32, iters: 22, time: 0.560, data: 2.093) G_GAN: 0.364 G_L1: 1.908 D_real: 0.267 D_fake: 0.315 KL_realB_fakeB: 0.105 
End of epoch 32 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
