----------------- Options ---------------
               batch_size: 1                             
                    beta1: 0.5                           
          checkpoints_dir: /home/otto.tavares/public/iltbi/rxpixp2pixcycle/checkpoints
           continue_train: False                         
                crop_size: 256                           
       custom_images_path: /home/otto.tavares/public/iltbi/train/images/santa_casa_pares/	[default: None]
        custom_masks_path: None                          
       custom_paired_path: None                          
                 dataroot: /home/otto.tavares/public/iltbi/train/images/santa_casa_pares/	[default: None]
           dataset_action: False                         
     dataset_download_dir: /home/otto.tavares/public/iltbi/rxpixp2pixcycle
             dataset_mode: santacasaskfold               	[default: aligned]
             dataset_name: Shenzhen                      
                direction: AtoB                          
              display_env: main                          
             display_freq: 400                           
               display_id: 1                             
            display_ncols: 4                             
             display_port: 8097                          
           display_server: http://localhost              
          display_winsize: 256                           
            download_imgs: False                         
                    epoch: latest                        
              epoch_count: 1                             
                 gan_mode: lsgan                         	[default: vanilla]
  generate_paths_data_csv: False                         
                  gpu_ids: 0                             
                init_gain: 0.02                          
                init_type: normal                        
                 input_nc: 3                             
                     isTB: False                         
                  isTrain: True                          	[default: None]
          is_resume_wandb: False                         
                      job: None                          
                lambda_L1: 50.0                          	[default: 100.0]
                load_iter: 0                             	[default: 0]
                load_size: 256                           	[default: 286]
                       lr: 0.0002                        
           lr_decay_iters: 50                            
                lr_policy: linear                        
         max_dataset_size: inf                           
                    model: pix2pix                       	[default: cycle_gan]
                 n_epochs: 100                           
           n_epochs_decay: 100                           
                  n_folds: 10                            
               n_layers_D: 3                             
                     name: santacasa_test_0_sort_1       	[default: experiment_name]
                      ndf: 64                            
                     netD: basic                         
                     netG: unet_256                      
                      ngf: 64                            
               no_dropout: False                         
                  no_flip: False                         
                  no_html: False                         
                     norm: batch                         
              num_threads: 4                             
                  num_val: 400                           
                output_nc: 3                             
                    phase: train                         
                pool_size: 0                             
               preprocess: resize_and_scale_width        	[default: resize_and_crop]
               print_freq: 100                           
                  project: p2p_santacasa                 	[default: None]
             save_by_iter: False                         
          save_epoch_freq: 5                             
         save_latest_freq: 5000                          
                     seed: 512                           	[default: 512]
           serial_batches: False                         
                     sort: 1                             	[default: 0]
                   suffix:                               
                     test: 0                             
                    token:                               
            train_dataset: True                          
         update_html_freq: 1000                          
                use_wandb: True                          	[default: False]
                 val_freq: 10                            	[default: 400]
                  verbose: False                         
             wandb_entity: otavares                      	[default: brics-tb]
            wandb_fold_id: wandb_id_test_0_sort_1        	[default: None]
----------------- End -------------------
GPU with device 0
                 images    gauss  ... all_together target
0   20220315_184023.jpg      seg  ...          seg      0
1   20220315_184432.jpg      seg  ...          seg      0
2   20220315_184701.jpg  not seg  ...          seg      0
3   20220315_184740.jpg      seg  ...          seg      0
4   20220315_185230.jpg      seg  ...          seg      0
..                  ...      ...  ...          ...    ...
83         IMG_5503.JPG  not seg  ...      not seg      0
84         IMG_5505.JPG      seg  ...          seg      0
85         IMG_5507.JPG      seg  ...          seg      0
86         IMG_5509.JPG      seg  ...          seg      0
87         IMG_5604.JPG      seg  ...          seg      0

[88 rows x 5 columns]
bins selected for val: [1, 2, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 2, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 7, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 7, 8]
dataset [SantaCasaSkfoldDataset] was created
                 images    gauss  ... all_together target
0   20220315_184023.jpg      seg  ...          seg      0
1   20220315_184432.jpg      seg  ...          seg      0
2   20220315_184701.jpg  not seg  ...          seg      0
3   20220315_184740.jpg      seg  ...          seg      0
4   20220315_185230.jpg      seg  ...          seg      0
..                  ...      ...  ...          ...    ...
83         IMG_5503.JPG  not seg  ...      not seg      0
84         IMG_5505.JPG      seg  ...          seg      0
85         IMG_5507.JPG      seg  ...          seg      0
86         IMG_5509.JPG      seg  ...          seg      0
87         IMG_5604.JPG      seg  ...          seg      0

[88 rows x 5 columns]
bins selected for val: [1, 2, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 2, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 3, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 4, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 5, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 6, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 7, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 8, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 7, 9]
bins selected for val: [0, 1, 2, 3, 4, 5, 6, 7, 8]
dataset [SantaCasaSkfoldDataset] was created
The number of training images = 40
The number of val images = 6
initialize network with normal
initialize network with normal
model [Pix2PixModel] was created
---------- Networks initialized -------------
[Network G] Total number of parameters : 54.414 M
[Network D] Total number of parameters : 2.769 M
-----------------------------------------------
Exception in user code:
------------------------------------------------------------


Could not connect to Visdom server. 
 Trying to start a server....
Command: /usr/bin/python3 -m visdom.server -p 8097 &>/dev/null &
create web directory /home/otto.tavares/public/iltbi/rxpixp2pixcycle/checkpoints/santacasa_test_0_sort_1/web...
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 1 / 200 	 Time Taken: 4 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 2 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.35066667199134827), ('G_L1', 6.841684818267822), ('D_real', 0.3603830933570862), ('D_fake', 0.31069764494895935), ('KL_realB_fakeB', 0.27929818529191974)])
(epoch: 3, iters: 20, time: 0.045, data: 0.505) G_GAN: 0.351 G_L1: 6.842 D_real: 0.360 D_fake: 0.311 KL_realB_fakeB: 0.279 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 3 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 4 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.659982442855835), ('G_L1', 5.873302936553955), ('D_real', 0.6773748397827148), ('D_fake', 0.7072330117225647), ('KL_realB_fakeB', 2.032309832198477)])
(epoch: 5, iters: 40, time: 0.044, data: 1.261) G_GAN: 0.660 G_L1: 5.873 D_real: 0.677 D_fake: 0.707 KL_realB_fakeB: 2.032 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 5, iters 200
End of epoch 5 / 200 	 Time Taken: 9 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 6 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 7 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.28336477279663086), ('G_L1', 3.9151928424835205), ('D_real', 0.264920175075531), ('D_fake', 0.24430154263973236), ('KL_realB_fakeB', 0.7845183363382998)])
(epoch: 8, iters: 20, time: 0.038, data: 0.147) G_GAN: 0.283 G_L1: 3.915 D_real: 0.265 D_fake: 0.244 KL_realB_fakeB: 0.785 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 8 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 9 / 200 	 Time Taken: 2 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.3625780940055847), ('G_L1', 4.727324962615967), ('D_real', 0.2658464312553406), ('D_fake', 0.31890687346458435), ('KL_realB_fakeB', 0.14668915436268326)])
(epoch: 10, iters: 40, time: 1.390, data: 1.749) G_GAN: 0.363 G_L1: 4.727 D_real: 0.266 D_fake: 0.319 KL_realB_fakeB: 0.147 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 10, iters 400
End of epoch 10 / 200 	 Time Taken: 10 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 11 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 12 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.44120702147483826), ('G_L1', 3.2568607330322266), ('D_real', 0.42304572463035583), ('D_fake', 0.3575390577316284), ('KL_realB_fakeB', 0.09928135690586155)])
(epoch: 13, iters: 20, time: 0.051, data: 0.468) G_GAN: 0.441 G_L1: 3.257 D_real: 0.423 D_fake: 0.358 KL_realB_fakeB: 0.099 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 13 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 14 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.2911604344844818), ('G_L1', 2.8015077114105225), ('D_real', 0.24771937727928162), ('D_fake', 0.2725244462490082), ('KL_realB_fakeB', 0.12379154684903576)])
(epoch: 15, iters: 40, time: 0.034, data: 1.618) G_GAN: 0.291 G_L1: 2.802 D_real: 0.248 D_fake: 0.273 KL_realB_fakeB: 0.124 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 15, iters 600
End of epoch 15 / 200 	 Time Taken: 8 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 16 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 17 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.4806953966617584), ('G_L1', 3.232633352279663), ('D_real', 0.37136760354042053), ('D_fake', 0.499928742647171), ('KL_realB_fakeB', 0.18971102376582555)])
(epoch: 18, iters: 20, time: 0.033, data: 0.526) G_GAN: 0.481 G_L1: 3.233 D_real: 0.371 D_fake: 0.500 KL_realB_fakeB: 0.190 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 18 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 19 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.3297788202762604), ('G_L1', 2.6056182384490967), ('D_real', 0.2760562300682068), ('D_fake', 0.2344917505979538), ('KL_realB_fakeB', 0.13771249585727965)])
(epoch: 20, iters: 40, time: 0.487, data: 1.751) G_GAN: 0.330 G_L1: 2.606 D_real: 0.276 D_fake: 0.234 KL_realB_fakeB: 0.138 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 20, iters 800
End of epoch 20 / 200 	 Time Taken: 9 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 21 / 200 	 Time Taken: 4 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 22 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.3552294671535492), ('G_L1', 3.5238146781921387), ('D_real', 0.40604791045188904), ('D_fake', 0.25823697447776794), ('KL_realB_fakeB', 0.12885701195828173)])
(epoch: 23, iters: 20, time: 0.044, data: 0.581) G_GAN: 0.355 G_L1: 3.524 D_real: 0.406 D_fake: 0.258 KL_realB_fakeB: 0.129 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 23 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 24 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.3296867907047272), ('G_L1', 3.0232174396514893), ('D_real', 0.3647797107696533), ('D_fake', 0.09175623953342438), ('KL_realB_fakeB', 0.32650222559032166)])
(epoch: 25, iters: 40, time: 0.032, data: 1.570) G_GAN: 0.330 G_L1: 3.023 D_real: 0.365 D_fake: 0.092 KL_realB_fakeB: 0.327 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 25, iters 1000
End of epoch 25 / 200 	 Time Taken: 8 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 26 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 27 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.37621551752090454), ('G_L1', 3.378383159637451), ('D_real', 0.21753093600273132), ('D_fake', 0.2676718831062317), ('KL_realB_fakeB', 0.5338339782749726)])
(epoch: 28, iters: 20, time: 0.047, data: 0.113) G_GAN: 0.376 G_L1: 3.378 D_real: 0.218 D_fake: 0.268 KL_realB_fakeB: 0.534 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 28 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 29 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.5010277628898621), ('G_L1', 2.6789705753326416), ('D_real', 0.14062432944774628), ('D_fake', 0.3840314447879791), ('KL_realB_fakeB', 0.09506799358049779)])
(epoch: 30, iters: 40, time: 0.504, data: 1.953) G_GAN: 0.501 G_L1: 2.679 D_real: 0.141 D_fake: 0.384 KL_realB_fakeB: 0.095 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 30, iters 1200
End of epoch 30 / 200 	 Time Taken: 11 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 31 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 32 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.387677937746048), ('G_L1', 2.349885940551758), ('D_real', 0.19101600348949432), ('D_fake', 0.23401696979999542), ('KL_realB_fakeB', 0.0989509830698192)])
(epoch: 33, iters: 20, time: 0.041, data: 0.108) G_GAN: 0.388 G_L1: 2.350 D_real: 0.191 D_fake: 0.234 KL_realB_fakeB: 0.099 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 33 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 34 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.376427561044693), ('G_L1', 2.7069926261901855), ('D_real', 0.1301218867301941), ('D_fake', 0.4357626736164093), ('KL_realB_fakeB', 0.3386224423626962)])
(epoch: 35, iters: 40, time: 0.044, data: 1.667) G_GAN: 0.376 G_L1: 2.707 D_real: 0.130 D_fake: 0.436 KL_realB_fakeB: 0.339 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 35, iters 1400
End of epoch 35 / 200 	 Time Taken: 11 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 36 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 37 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.4221116304397583), ('G_L1', 1.8522772789001465), ('D_real', 0.23618845641613007), ('D_fake', 0.2893330752849579), ('KL_realB_fakeB', 0.09468635826511591)])
(epoch: 38, iters: 20, time: 0.047, data: 0.576) G_GAN: 0.422 G_L1: 1.852 D_real: 0.236 D_fake: 0.289 KL_realB_fakeB: 0.095 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 38 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
End of epoch 39 / 200 	 Time Taken: 3 sec
learning rate 0.0002000 -> 0.0002000
OrderedDict([('G_GAN', 0.22933852672576904), ('G_L1', 1.777411937713623), ('D_real', 0.32443752884864807), ('D_fake', 0.1978091597557068), ('KL_realB_fakeB', 0.12506090148229515)])
(epoch: 40, iters: 40, time: 0.686, data: 1.586) G_GAN: 0.229 G_L1: 1.777 D_real: 0.324 D_fake: 0.198 KL_realB_fakeB: 0.125 
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
end of validation step
saving the model at the end of epoch 40, iters 1600
End of epoch 40 / 200 	 Time Taken: 9 sec
learning rate 0.0002000 -> 0.0002000
