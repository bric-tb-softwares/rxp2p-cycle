  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 1807.37it/s]
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 9309.18it/s]
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 9069.85it/s]
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 9309.18it/s]
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 9137.92it/s]
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 9311.48it/s]
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 9277.15it/s]
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 9096.08it/s]
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 9268.04it/s]
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 9216.00it/s]
/home/otto.tavares/.local/lib/python3.9/site-packages/torchvision/transforms/transforms.py:332: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
/home/otto.tavares/.local/lib/python3.9/site-packages/torch/utils/data/dataloader.py:563: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 8711.92it/s]
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 9155.65it/s]
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 9265.77it/s]
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 9316.08it/s]
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 9332.20it/s]
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 8940.96it/s]
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 9288.57it/s]
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 9024.32it/s]
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 9329.89it/s]
  0%|          | 0/9 [00:00<?, ?it/s]100%|██████████| 9/9 [00:00<00:00, 9320.68it/s]
/home/otto.tavares/.local/lib/python3.9/site-packages/torchvision/transforms/transforms.py:332: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
/home/otto.tavares/.local/lib/python3.9/site-packages/torch/utils/data/dataloader.py:563: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Setting up a new session...
Traceback (most recent call last):
  File "/home/otto.tavares/.local/lib/python3.9/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/otto.tavares/.local/lib/python3.9/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/home/otto.tavares/.local/lib/python3.9/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/otto.tavares/.local/lib/python3.9/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/otto.tavares/.local/lib/python3.9/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/home/otto.tavares/.local/lib/python3.9/site-packages/urllib3/connection.py", line 239, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/lib/python3.9/http/client.py", line 1255, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/lib/python3.9/http/client.py", line 1301, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.9/http/client.py", line 1250, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.9/http/client.py", line 1010, in _send_output
    self.send(msg)
  File "/usr/lib/python3.9/http/client.py", line 950, in send
    self.connect()
  File "/home/otto.tavares/.local/lib/python3.9/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/home/otto.tavares/.local/lib/python3.9/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fcb53479ca0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/otto.tavares/.local/lib/python3.9/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/otto.tavares/.local/lib/python3.9/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/otto.tavares/.local/lib/python3.9/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fcb53479ca0>: Failed to establish a new connection: [Errno 111] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/otto.tavares/.local/lib/python3.9/site-packages/visdom/__init__.py", line 692, in _send
    return self._handle_post(
  File "/home/otto.tavares/.local/lib/python3.9/site-packages/visdom/__init__.py", line 656, in _handle_post
    r = self.session.post(url, data=data)
  File "/home/otto.tavares/.local/lib/python3.9/site-packages/requests/sessions.py", line 635, in post
    return self.request("POST", url, data=data, json=json, **kwargs)
  File "/home/otto.tavares/.local/lib/python3.9/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/otto.tavares/.local/lib/python3.9/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/otto.tavares/.local/lib/python3.9/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8097): Max retries exceeded with url: /env/main (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fcb53479ca0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[Errno 111] Connection refused
on_close() takes 1 positional argument but 3 were given
wandb: Currently logged in as: otavares. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.6 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.13.5
wandb: Run data is saved locally in /home/otto.tavares/public/iltbi/rxp2p-cycle/wandb/run-20240507_103502-cycle_ntb_test_0_sort_6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run test_0_sort_6
wandb: ⭐️ View project at https://wandb.ai/otavares/cycle_shenzhen_ntb_santacasa
wandb: 🚀 View run at https://wandb.ai/otavares/cycle_shenzhen_ntb_santacasa/runs/cycle_ntb_test_0_sort_6
/home/otto.tavares/.local/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
/home/otto.tavares/.local/lib/python3.9/site-packages/torch/utils/data/dataloader.py:563: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
wandb: Network error (TransientError), entering retry loop.
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:                D_A ▃▄▃▆▁▂▄▂▆▆▇█▃▄▃▆▅▆▂▁▃▃▂▅▅▁▂▁▁▁▂▂▁▂▃▁▂▃▁▃
wandb:            D_A_val ▂▂▂▂▁▁▂▁▃▂▃▂▂▂▁▂▂▂▃▁▁▁▁▂▂▂▁▁▂▁▁▃▂▂▁▃▃▆▅█
wandb:                D_B ▃▅▇▅▂▃▄▃▂▄█▄▅▆▂▂▄▂▂▆▃▂▂▅▂▄▁▂▂▃▂▂▁▂▂▃▅▂▃▃
wandb:            D_B_val ▂▂▃▃▂▃▂▃▁▃▂▃▁▃▁▁▁▂▂▃▃▆▃▂▃▂▂▄▁▃▂▃▂▆▂▆▆▆█▇
wandb:                G_A ▅█▂▂▄▄▆▃▂▂▂▂▃▃▆▂▁▂▂▅▄█▅▂▂▃▄▄▃▆▄▄▄▃▃▆▄▃▆▃
wandb:            G_A_val ▄▃▂▂▃▃▂▃▁▁▁▁▃▁▅▁▂▃▁▂▄▂▂▆▁▁▄▃▄▃▄▂▃▇▇▄▄▆██
wandb:                G_B ▅▂▂▂▄▄█▃▃▁▂▄▂▁▄▄▂▅▁▂▃▄▃▆▅▅▄▅▃▄▅▃▄▆▃▄▄▃▄▄
wandb:            G_B_val ▃▄▂▂▂▃▂▅▂▁▂▂▄▁▄▃▃▅▃▁▃█▄▂▂▂▄▂▃▃▂▁▄▄▅▃▃▄▅▄
wandb:     KL_realA_fakeA ▂▅▁▂▅▂▂▄▆▂▃▁▆▂▂▁▄▃▇▂▄▁▅▆█▃▄▂▄▂▂▁▂▂▅▄▂▁▁▂
wandb: KL_realA_fakeA_val ▂▃▃▂▂▁▃▂▃▁▂▁▃▁▃▁▃▁▁▁▁▁▃▃▂▃▁▃▁█▁▁▁▁▁▅▄▁▄▁
wandb:     KL_realB_fakeB ▂█▃▂▂▂▃▃▃▂▂▂▃▂▁▁▂▃▁▂▁▂▂▃▂▂▂▁▂▁▂▃▂▁▄▃▁▁▂▁
wandb: KL_realB_fakeB_val ▁▆▃▁▁▂▃█▁▂▂▂▂▃▂▁▆▂▄▃▁▁▂▂▂▁▄▂▁▃▂▃▂▁▂▁▁▁▂▂
wandb:            cycle_A █▅▇▅▇█▅▄▂▃▃▂▂▃▄▃▂▂▃▃▂▂▄▂▁▃▂▃▃▄▃▃▃▄▁▂▂▂▂▃
wandb:        cycle_A_val ▇▆▅█▆▆▃▄▁▄▅▂▂▃▂▃▃▃▃▃▃▃▃▃▁▃▂▂▂▂▃▂▂▄▂▃▃▃▂▃
wandb:            cycle_B █▃▇▃▃▃▆▄▃▄▂▃▂▃▂▁▅▂▃▂▂▆▃▄▂▃▂▂▂▂▂▄▁▃▂▁▁▁▁▁
wandb:        cycle_B_val █▄▃▆▃▂▄▂▂▂▂▁▂▂▃▁▃▂▂▂▂▂▁▂▂▂▁▂▁▁▁▁▁▃▂▁▁▂▁▂
wandb:              idt_A ▆▃█▃▂▃▇▄▃▆▂▃▂▄▂▂▄▂▂▂▂▄▃▄▁▂▂▂▂▂▂▃▂▂▁▁▁▁▁▁
wandb:          idt_A_val █▄▃▅▂▂▅▃▄▂▂▂▃▂▂▁▃▂▂▃▂▂▂▂▁▂▁▂▁▁▁▂▁▂▁▁▁▂▁▂
wandb:              idt_B █▃▄▃▅▅▃▂▂▃▂▂▂▂▂▂▁▁▂▂▁▂▂▁▁▂▁▂▂▂▂▂▁▂▁▁▁▁▁▂
wandb:          idt_B_val █▅▆█▅▆▃▆▁▅▁▃▃▅▂▇▂▃▃▃▅█▂▂▁▂▂▂▂▂▅▁▂▃▂▃▃▂▂▅
wandb: 
wandb: Run summary:
wandb:                D_A 0.06099
wandb:            D_A_val 1.14051
wandb:                D_B 0.04214
wandb:            D_B_val 0.70131
wandb:                G_A 0.73296
wandb:            G_A_val 1.83293
wandb:                G_B 0.67976
wandb:            G_B_val 0.78293
wandb:     KL_realA_fakeA 0.13389
wandb: KL_realA_fakeA_val 0.07173
wandb:     KL_realB_fakeB 0.20837
wandb: KL_realB_fakeB_val 0.1255
wandb:            cycle_A 0.53462
wandb:        cycle_A_val 0.6715
wandb:            cycle_B 0.34997
wandb:        cycle_B_val 0.44798
wandb:              idt_A 0.11345
wandb:          idt_A_val 0.16996
wandb:              idt_B 0.18551
wandb:          idt_B_val 0.38978
wandb: 
wandb: Synced test_0_sort_6: https://wandb.ai/otavares/cycle_shenzhen_ntb_santacasa/runs/cycle_ntb_test_0_sort_6
wandb: Synced 6 W&B file(s), 1170 media file(s), 1092 artifact file(s) and 1 other file(s)
wandb: Find logs at: ./wandb/run-20240507_103502-cycle_ntb_test_0_sort_6/logs
